1.
SELECT PRODUCT_FAMILY.PRODFAM_ID,
	COUNT(ORDER_DETAILS.PROD_ID) AS 'Total Quantity Sold',
	SUM(SELLING_PRICE) AS 'Total Dollar Amount' 
FROM PRODUCT_FAMILY INNER JOIN PRODUCT_SUBFAMILY
	ON PRODUCT_FAMILY.PRODFAM_ID = PRODUCT_SUBFAMILY.PRODFAM_ID
INNER JOIN PRODUCTS 
	ON PRODUCT_SUBFAMILY.SUBFAM_ID = PRODUCTS.SUBFAM_ID
INNER JOIN ORDER_DETAILS
	ON PRODUCTS.PROD_ID = ORDER_DETAILS.PROD_ID
GROUP BY PRODUCT_FAMILY.PRODFAM_ID;

2.
SELECT PRODUCT_SUBFAMILY.SUBFAM_ID,
	COUNT(ORDER_DETAILS.PROD_ID) AS 'Total Quantity Sold',
	SUM(SELLING_PRICE) AS 'Total Dollar Amount' 
FROM PRODUCT_SUBFAMILY INNER JOIN PRODUCTS 
	ON PRODUCT_SUBFAMILY.SUBFAM_ID = PRODUCTS.SUBFAM_ID
INNER JOIN ORDER_DETAILS
	ON PRODUCTS.PROD_ID = ORDER_DETAILS.PROD_ID
GROUP BY PRODUCT_SUBFAMILY.SUBFAM_ID;

3.
SELECT PRODUCTS.PROD_ID,
	COUNT(ORDER_DETAILS.PROD_ID) AS 'Total Quantity Sold',
	SUM(SELLING_PRICE) AS 'Total Dollar Amount' 
FROM PRODUCTS INNER JOIN ORDER_DETAILS
	ON PRODUCTS.PROD_ID = ORDER_DETAILS.PROD_ID
WHERE PRODUCTS.PROD_ID = '1' OR PRODUCTS.PROD_ID = '2'
GROUP BY PRODUCTS.PROD_ID;

4.
SELECT PRODUCTS.PROD_ID,
	COUNT(ORDER_DETAILS.PROD_ID) AS 'Total Quantity Sold',
	SUM(SELLING_PRICE) AS 'Total Dollar Amount' 
FROM PRODUCTS INNER JOIN ORDER_DETAILS
	ON PRODUCTS.PROD_ID = ORDER_DETAILS.PROD_ID
GROUP BY PRODUCTS.PROD_ID;

5.
SELECT PRODUCT_FAMILY.PRODFAM_DESC,
	PRODUCT_SUBFAMILY.SUBFAM_DESC,
	PRODUCTS.PROD_DESC
FROM PRODUCT_FAMILY INNER JOIN PRODUCT_SUBFAMILY
	ON PRODUCT_FAMILY.PRODFAM_ID = PRODUCT_SUBFAMILY.PRODFAM_ID
INNER JOIN PRODUCTS
	ON PRODUCT_SUBFAMILY.SUBFAM_ID = PRODUCTS.SUBFAM_ID
GROUP BY PRODUCT_FAMILY.PRODFAM_DESC,
	PRODUCT_SUBFAMILY.SUBFAM_DESC,
	PRODUCTS.PROD_DESC;

6.
SELECT((SELECT COUNT(PRODUCTS.PROD_ID)
	FROM PRODUCTS INNER JOIN ORDER_DETAILS
		ON PRODUCTS.PROD_ID = ORDER_DETAILS.PROD_ID
	WHERE PRODUCTS.PROD_ID = '1' OR PRODUCTS.PROD_ID = '2') / 
	COUNT(PRODUCTS.PROD_ID)) AS 'Average Pizzas per Order'
FROM PRODUCTS INNER JOIN ORDER_DETAILS
	ON PRODUCTS.PROD_ID = ORDER_DETAILS.PROD_ID;

7.
SELECT PRODUCT_FAMILY.PRODFAM_DESC,
	AVG(PRODUCTS.PRICE) AS 'Average Price'
FROM PRODUCT_FAMILY INNER JOIN PRODUCT_SUBFAMILY
	ON PRODUCT_FAMILY.PRODFAM_ID = PRODUCT_SUBFAMILY.PRODFAM_ID
INNER JOIN PRODUCTS
	ON PRODUCT_SUBFAMILY.SUBFAM_ID = PRODUCTS.SUBFAM_ID
GROUP BY PRODUCT_FAMILY.PRODFAM_DESC;

8.
SELECT  DISTINCT CUST_ID AS 'Customers who have ordered pizza or pasta'
FROM ORDERS INNER JOIN ORDER_DETAILS
	ON ORDERS.ORDER_ID = ORDER_DETAILS.ORDER_ID
WHERE ORDER_DETAILS.PROD_ID = '1' 
	OR ORDER_DETAILS.PROD_ID = '2'
	OR ORDER_DETAILS.PROD_ID = '4';

9.
SELECT PRODUCTS.PROD_DESC,
	(SELECT(AVG(QTY)) FROM ORDER_DETAILS) AS 'Avg Qty Sold of All Products',
	(QTY - (SELECT(AVG(QTY)) FROM ORDER_DETAILS)) AS 'Amount Above Avg'
FROM PRODUCTS INNER JOIN ORDER_DETAILS
	ON PRODUCTS.PROD_ID = ORDER_DETAILS.PROD_ID
WHERE (QTY - (SELECT(AVG(QTY)) FROM ORDER_DETAILS)) > 0
GROUP BY PRODUCTS.PROD_DESC,
	ORDER_DETAILS.QTY;

10.
SELECT PROD_DESC,
	PRICE,
	(SELECT(AVG(PRICE)) FROM PRODUCTS) AS 'Average',
	(PRICE - (SELECT(AVG(PRICE)) FROM PRODUCTS)) AS 'Difference'
FROM PRODUCTS
GROUP BY PROD_DESC,
	PRODUCTS.PRICE;